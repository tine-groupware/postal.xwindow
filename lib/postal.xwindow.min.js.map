{"version":3,"sources":["postal.xwindow.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_1__","__WEBPACK_EXTERNAL_MODULE_2__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequire","obj","__esModule","_","postal","_utils","_memoRemoteByInstanceId","_memoRemoteByTarget","_disconnectClient","safeSerialize","_state","state","env","XWindowClient","getInstance","target","options","instanceId","fedx","transports","xwindow","eagerSerialize","useEagerSerialize","remotes","configure","cfg","config","defaults","extend","clearConfiguration","disconnect","clients","reduce","isArray","doNotNotify","each","without","apply","concat","getTargets","tidyStorage","store","namespace","localStoragePrefix","getAll","memo","targetData","match","targetId","split","push","sendMessage","envelope","cloneDeep","remote","wrapForTransport","packingSlip","JSON","stringify","unwrapFromTransport","msgData","indexOf","parse","ex","routeMessage","event","_this","parsed","newValue","find","x","onMessage","signalReady","targets","callback","that","on","bind","keepAlive","length","def","sendPing","set","Date","getTime","targetTimeout","tidyRemotes","delay","Math","round","now","value","clear","isEmpty","proxy","tgt","client","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","entries","Symbol","iterator","next","done","_step$value","_slicedToArray","key","val","isPlainObject","err","arr","i","Array","Object","_arr","TypeError","defineProperty","regeneratorRuntime","mark","k","wrap","context$1$0","prev","keys","t0","finish","stop","origin","location","protocol","host","isWorker","window","postMessage","test","navigator","userAgent","enabled","workers","_createClass","defineProperties","props","prop","configurable","writable","Constructor","protoProps","staticProps","prototype","_get","get","object","property","receiver","desc","getOwnPropertyDescriptor","parent","getPrototypeOf","getter","_inherits","subClass","superClass","create","constructor","enumerable","__proto__","_classCallCheck","instance","_postal$fedx$FederationClient","_len","arguments","args","_key","transportName","send","msg","FederationClient"],"mappings":";;;;;;;CAOA,SAA2CA,EAAMC,GAC1B,gBAAZC,UAA0C,gBAAXC,QACxCA,OAAOD,QAAUD,EAAQG,QAAQ,UAAWA,QAAQ,WAC3B,kBAAXC,SAAyBA,OAAOC,IAC9CD,QAAQ,SAAU,UAAWJ,GACH,gBAAZC,SACdA,QAAuB,cAAID,EAAQG,QAAQ,UAAWA,QAAQ,WAE9DJ,EAAoB,cAAIC,EAAQD,EAAQ,EAAGA,EAAa,UACvDO,KAAM,SAASC,EAA+BC,GACjD,MAAgB,UAAUC,GAKhB,QAASC,GAAoBC,GAG5B,GAAGC,EAAiBD,GACnB,MAAOC,GAAiBD,GAAUV,OAGnC,IAAIC,GAASU,EAAiBD,IAC7BV,WACAY,GAAIF,EACJG,QAAQ,EAUT,OANAL,GAAQE,GAAUI,KAAKb,EAAOD,QAASC,EAAQA,EAAOD,QAASS,GAG/DR,EAAOY,QAAS,EAGTZ,EAAOD,QAvBf,GAAIW,KAqCJ,OATAF,GAAoBM,EAAIP,EAGxBC,EAAoBO,EAAIL,EAGxBF,EAAoBQ,EAAI,GAGjBR,EAAoB,KAK/B,SAASR,EAAQD,EAASS,GAI/B,GAAIS,GAAkB,SAAUC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,EAAI,WAAaA,GAEnFE,EAAIH,EAAgBT,EAAoB,IAExCa,EAASJ,EAAgBT,EAAoB,IAE7Cc,EAASd,EAAoB,GAE7Be,EAA0BD,EAAOC,wBACjCC,EAAsBF,EAAOE,oBAC7BC,EAAoBH,EAAOG,kBAC3BC,EAAgBJ,EAAOI,cAEvBC,EAASnB,EAAoB,GAE7BoB,EAAQD,EAAOC,MACfC,EAAMF,EAAOE,IAEbC,EAAgBb,EAAgBT,EAAoB,GAExDsB,GAAcC,YAAc,SAAUC,EAAQC,EAASC,GACtD,MAAO,IAAIJ,GAAcE,EAAQC,EAASC,IAG3Cb,EAAOc,KAAKC,WAAWC,SACtBC,eAAgBT,EAAIU,kBACpBC,WACAV,cAAeA,EACfW,UAAW,SAAmBC,GAI7B,MAHIA,KACHd,EAAMe,OAASvB,EAAEwB,SAASxB,EAAEyB,OAAOjB,EAAMe,OAAQD,GAAMd,EAAMgB,WAEvDhB,EAAMe,QAEdG,mBAAoB,WACnBlB,EAAMe,OAASvB,EAAEyB,UAAWjB,EAAMgB,WAEnCG,WAAY,SAAoBd,GAC/BA,EAAUA,KACV,IAAIe,GAAUf,EAAQC,WAEtBd,EAAE6B,OAAO7B,EAAE8B,QAAQjB,EAAQC,YAAcD,EAAQC,YAAcD,EAAQC,YAAaX,KAA6BnB,MAEjH6B,EAAQD,OAERZ,EAAE6B,OAAO7B,EAAE8B,QAAQjB,EAAQD,QAAUC,EAAQD,QAAUC,EAAQD,QAASR,KAAyBpB,MAEjGA,KAAKoC,OACAP,GAAQkB,aACZ/B,EAAEgC,KAAKJ,EAASvB,EAAmBrB,MAEpCA,KAAKoC,QAAUpB,EAAEiC,QAAQC,MAAM,MAAOlD,KAAKoC,SAASe,OAAOP,KAE5DQ,WAAY,WAEX,MADApD,MAAKqD,cACErC,EAAE6B,OAAOS,MAAMC,UAAU/B,EAAMe,OAAOiB,oBAAoBC,SAAU,SAAUC,EAAMC,EAAYpD,GACtG,GAAIA,EAAGqD,MAAM,oBAAqB,CACjC,GAAIC,GAAWtD,EAAGuD,MAAM,KAAK,EAC7BJ,GAAKK,MACJF,SAAUA,EACVjC,OAAQ0B,MAAMC,UAAU/B,EAAMe,OAAOiB,mBAAqB,IAAMK,KAGlE,MAAOH,SAGTM,YAAa,SAAqBvC,GACjC,GAAIwC,GAAWxC,CACXD,GAAMe,OAAOjB,gBAChB2C,EAAW3C,EAAcN,EAAEkD,UAAUzC,IAEtC,IAAIK,GAAab,EAAOa,YAExBd,GAAEgC,KAAKhD,KAAKoC,QAAS,SAAU+B,GAC1BA,EAAOrC,YAAcA,GACxBqC,EAAOH,YAAYC,MAItBG,iBAAkB3C,EAAIU,kBAAoB,SAAUkC,GACnD,MAAOC,MAAKC,WACXtD,QAAQ,EACRoD,YAAaA,KAEX,SAAUA,GACb,OACCpD,QAAQ,EACRoD,YAAaA,IAGfG,oBAAqB,SAA6BC,GACjD,GAAuB,gBAAZA,KAAyBhD,EAAIU,mBAA4D,KAAvCsC,EAAQC,QAAQ,iBAO5E,MAAOD,EANP,KACC,MAAOH,MAAKK,MAAMF,GACjB,MAAOG,GACR,WAMHC,aAAc,SAAsBC,GACnC,GAAIC,GAAQ/E,KAERgF,EAAShF,KAAKwE,oBAAoBM,EAAMG,SAC5C,IAAID,GAAUA,EAAO/D,OAAQ,CAC5B,GAAIkD,IAEJ,WACC,GAAIE,GAAcW,EAAOX,YACrBvC,EAAauC,EAAYvC,UACzBuC,IAAevC,GAAcb,EAAOa,eACvCqC,EAASnD,EAAEkE,KAAKH,EAAM3C,QAAS,SAAU+C,GACxC,MAAOA,GAAErD,aAAeA,IAGpBqC,IACJA,EAASzC,EAAcC,YAAY2B,MAAMC,UAAU/B,EAAMe,OAAOiB,mBAAqB,IAAM1B,MAAiBA,GAC5GiD,EAAM3C,QAAQ2B,KAAKI,IAEpBA,EAAOiB,UAAUf,UAKrBgB,YAAa,SAAqBC,EAASC,GAC1C,GAAIzD,GAAab,EAAOa,aACpB0D,EAAOxF,IAEXA,MAAK4B,OAAS0B,MAAMC,UAAU/B,EAAMe,OAAOiB,mBAAqB,IAAM1B,GACtE9B,KAAK4B,OAAO6D,GAAG,UAAWzE,EAAE0E,KAAK1F,KAAK6E,aAAc7E,OACpDA,KAAK2F,YAELL,EAAUtE,EAAE8B,QAAQwC,GAAWA,GAAWA,GAC1CA,EAAUA,EAAQM,OAASN,EAAUtF,KAAKoD,aAC1CmC,EAAWA,GAAY,aAEvBvE,EAAEgC,KAAKsC,EAAS,SAAUO,GACzB,GAAIA,EAAIhC,UAAY/B,EAAY,CAC/B,GAAIqC,GAASnD,EAAEkE,KAAKM,EAAKpD,QAAS,SAAU+C,GAC3C,MAAOA,GAAErD,aAAe+D,EAAIhC,UAExBM,KACJA,EAASzC,EAAcC,YAAYkE,EAAIjE,UAAYiE,EAAIhC,UACvD2B,EAAKpD,QAAQ2B,KAAKI,IAEnBA,EAAO2B,SAASP,KAEfvF,OAEJ2F,UAAW,WACV3F,KAAK4B,OAAOmE,IAAI,iBAAiB,GAAIC,OAAOC,UAAYzE,EAAMe,OAAO2D,eACrElG,KAAKqD,cACLrD,KAAKmG,cAELnF,EAAEoF,MAAMpF,EAAE0E,KAAK1F,KAAK2F,UAAW3F,MAAOqG,KAAKC,MAAM9E,EAAMe,OAAO2D,cAAgB,KAE/E7C,YAAa,WACZ,GAAIkD,IAAM,GAAIP,OAAOC,SACrBjF,GAAEgC,KAAKM,MAAMC,UAAU/B,EAAMe,OAAOiB,oBAAoBC,SAAU,SAAU+C,EAAOjG,GAClF,GAAIA,EAAGqD,MAAM,qBAA+B2C,EAARC,EAAa,CAChD,GAAI1E,GAAavB,EAAGuD,MAAM,KAAK,EAC/BR,OAAMC,UAAU/B,EAAMe,OAAOiB,mBAAqB,IAAM1B,GAAY2E,YAIvEN,YAAa,WACZ,GAAIX,GAAOxF,IACXgB,GAAEgC,KAAKhD,KAAKoC,QAAS,SAAU+B,GAC1BnD,EAAE0F,QAAQvC,EAAOvC,OAAO6B,WAC3B+B,EAAK7C,YAAaf,OAAQuC,EAAOvC,cAQhC,SAAShC,EAAQD,GAEtBC,EAAOD,QAAUM,GAIZ,SAASL,EAAQD,GAEtBC,EAAOD,QAAUO,GAIZ,SAASN,EAAQD,EAASS,GAoB/B,QAASe,GAAwBuC,EAAM5B,GACtC,GAAI6E,GAAQ3F,EAAEkE,KAAKlF,KAAKoC,QAAS,SAAU+C,GAC1C,MAAOA,GAAErD,aAAeA,GAKzB,OAHI6E,IACHjD,EAAKK,KAAK4C,GAEJjD,EAGR,QAAStC,GAAoBsC,EAAMkD,GAClC,GAAID,GAAQ3F,EAAEkE,KAAKlF,KAAKoC,QAAS,SAAU+C,GAC1C,MAAOA,GAAEvD,SAAWgF,GAKrB,OAHID,IACHjD,EAAKK,KAAK4C,GAEJjD,EAGR,QAASrC,GAAkBwF,GAC1BA,EAAOlE,aAGR,QAASrB,GAAc2C,GACtB,GAAI6C,IAA4B,EAC5BC,GAAoB,EACpBC,EAAiBC,MAErB,KACC,IAAK,GAAsDC,GAAlDC,EAAYC,EAAQnD,GAAUoD,OAAOC,cAAsBR,GAA6BI,EAAQC,EAAUI,QAAQC,MAAOV,GAA4B,EAAM,CACnK,GAAIW,GAAcC,EAAeR,EAAMV,MAAO,GAE1CmB,EAAMF,EAAY,GAClBG,EAAMH,EAAY,EAEH,mBAARG,UACH3D,GAAS0D,GAEb3G,EAAE6G,cAAcD,IACnBtG,EAAcsG,GAEX5G,EAAE8B,QAAQ8E,IACb5G,EAAEgC,KAAK4E,EAAKtG,IAGb,MAAOwG,GACRf,GAAoB,EACpBC,EAAiBc,EAChB,QACD,KACMhB,GAA6BK,EAAU,WAC3CA,EAAU,YAEV,QACD,GAAIJ,EACH,KAAMC,IAKT,MAAO/C,GA7ER,GAAIpD,GAAkB,SAAUC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,EAAI,WAAaA,GAInF4G,EAAiB,SAAUK,EAAKC,GAAK,GAAIC,MAAMnF,QAAQiF,GAAQ,MAAOA,EAAY,IAAIV,OAAOC,WAAYY,QAAOH,GAAM,CAAiB,IAAK,GAAwCb,GAAxDiB,KAAoBhB,EAAYY,EAAIV,OAAOC,cAAsBJ,EAAQC,EAAUI,QAAQC,OAASW,EAAKpE,KAAKmD,EAAMV,QAAYwB,GAAKG,EAAKvC,SAAWoC,KAAY,MAAOG,GAAe,KAAM,IAAIC,WAAU,wDAE3UzI,GAAQwB,wBAA0BA,EAClCxB,EAAQyB,oBAAsBA,EAC9BzB,EAAQ0B,kBAAoBA,EAC5B1B,EAAQ2B,cAAgBA,EACxB4G,OAAOG,eAAe1I,EAAS,cAC9B6G,OAAO,GAGR,IAAIxF,GAAIH,EAAgBT,EAAoB,IAkExCgH,EAAUkB,mBAAmBC,KAAK,QAASnB,GAAQtG,GACtD,GAAIgG,GAA2BC,EAAmBC,EAAgBG,EAAWD,EAAOsB,CAEpF,OAAOF,oBAAmBG,KAAK,SAAkBC,GAChD,OAAU,OAAQA,EAAYC,KAAOD,EAAYnB,MAChD,IAAK,GAC+C,MAA9C,SAAU,YAAY7C,cAAe5D,MACzCA,MAEDgG,GAA4B,EAC5BC,GAAoB,EACpBC,EAAiBC,OACjByB,EAAYC,KAAO,EACnBxB,EAAYe,OAAOU,KAAK9H,GAAKuG,OAAOC,WAErC,KAAK,GACJ,GAAIR,GAA6BI,EAAQC,EAAUI,QAAQC,KAAM,CAChEkB,EAAYnB,KAAO,EACnB,OAKD,MAFAiB,GAAItB,EAAMV,MACVkC,EAAYnB,KAAO,IACXiB,EAAG1H,EAAI0H,GAEhB,KAAK,IACJ1B,GAA4B,EAC5B4B,EAAYnB,KAAO,CACnB,MAED,KAAK,IACJmB,EAAYnB,KAAO,EACnB,MAED,KAAK,IACJmB,EAAYC,KAAO,GACnBD,EAAYG,GAAKH,EAAY,SAAS,GACtC3B,GAAoB,EACpBC,EAAiB0B,EAAYG,EAE9B,KAAK,IACJH,EAAYC,KAAO,GACnBD,EAAYC,KAAO,IAEd7B,GAA6BK,EAAU,WAC3CA,EAAU,WAGZ,KAAK,IAGJ,GAFAuB,EAAYC,KAAO,IAEd5B,EAAmB,CACvB2B,EAAYnB,KAAO,EACnB,OAGD,KAAMP,EAEP,KAAK,IACJ,MAAO0B,GAAYI,OAAO,GAE3B,KAAK,IACJ,MAAOJ,GAAYI,OAAO,GAE3B,KAAK,IACL,IAAK,MACJ,MAAOJ,GAAYK,SAEnB3B,EAASpH,OAAQ,EAAG,GAAI,GAAI,KAAM,GAAG,CAAE,GAAI,OAE/CL,GAAQyH,QAAUA,GAIb,SAASxH,EAAQD,EAASS,GAI/B,GAAIS,GAAkB,SAAUC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,EAAI,WAAaA,EAEvFoH,QAAOG,eAAe1I,EAAS,cAC9B6G,OAAO,GAGR,IAAIxF,GAAIH,EAAgBT,EAAoB,IAExCqB,GACHuH,OAAQC,SAASD,QAAUC,SAASC,SAAW,KAAOD,SAASE,KAC/DC,SAA4B,mBAAXC,SAA0BC,aAAeL,SAQ1D9G,kBAAmB,aAAaoH,KAAKC,UAAUC,WAGhD9J,GAAQ8B,IAAMA,CACd,IAAIe,IACHkH,SAAS,EACTlG,mBAAoB,sBACpB0C,cAAe,IACf5E,eAAe,GAGZE,GACHmI,WACApH,OAAQvB,EAAEyB,UAAWD,GACrBA,SAAUA,EAEX7C,GAAQ6B,MAAQA,GAIX,SAAS5B,EAAQD,EAASS,GAI/B,GAAIS,GAAkB,SAAUC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,EAAI,WAAaA,GAInF8I,EAAe,WAAe,QAASC,GAAiBjI,EAAQkI,GAAS,IAAK,GAAInC,KAAOmC,GAAO,CAAE,GAAIC,GAAOD,EAAMnC,EAAMoC,GAAKC,cAAe,EAAUD,EAAKvD,QAAOuD,EAAKE,UAAW,GAAQ/B,OAAO2B,iBAAiBjI,EAAQkI,GAAU,MAAO,UAAUI,EAAaC,EAAYC,GAAiJ,MAA9HD,IAAYN,EAAiBK,EAAYG,UAAWF,GAAiBC,GAAaP,EAAiBK,EAAaE,GAAqBF,MAIvaI,EAAO,QAASC,GAAIC,EAAQC,EAAUC,GAAY,GAAIC,GAAOzC,OAAO0C,yBAAyBJ,EAAQC,EAAW,IAAaxD,SAAT0D,EAAoB,CAAE,GAAIE,GAAS3C,OAAO4C,eAAeN,EAAS,OAAe,QAAXK,EAAmB,OAAkCN,EAAIM,EAAQJ,EAAUC,GAAoB,GAAI,SAAWC,IAAQA,EAAKV,SAAY,MAAOU,GAAKnE,KAAgB,IAAIuE,GAASJ,EAAKJ,GAAK,IAAetD,SAAX8D,EAA4C,MAAOA,GAAOtK,KAAKiK,IAIvbM,EAAY,SAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAI9C,WAAU,iEAAoE8C,GAAeD,GAASZ,UAAYnC,OAAOiD,OAAOD,GAAcA,EAAWb,WAAae,aAAe5E,MAAOyE,EAAUI,YAAY,EAAOpB,UAAU,EAAMD,cAAc,KAAekB,IAAYD,EAASK,UAAYJ,IAI9ZK,EAAkB,SAAUC,EAAUtB,GAAe,KAAMsB,YAAoBtB,IAAgB,KAAM,IAAI9B,WAAU,sCAEnHnH,EAASJ,EAAgBT,EAAoB,IAI7CsB,EAAgB,SAAW+J,GAC5B,QAAS/J,KACN,IAAK,GAAIgK,GAAOC,UAAU/F,OAAQgG,EAAO3D,MAAMyD,GAAOG,EAAO,EAAUH,EAAPG,EAAaA,IAC1ED,EAAKC,GAAQF,UAAUE,EAG1BN,GAAgBvL,KAAM0B,GAEtB1B,KAAK8L,cAAgB,UACrBxB,EAAKpC,OAAO4C,eAAepJ,EAAc2I,WAAY,cAAerK,MAAMkD,MAAMlD,KAAM4L,GAczF,MAXAZ,GAAUtJ,EAAe+J,GAEzB7B,EAAalI,GACVqK,MACGvF,MAAO,SAAcnC,GAClB,GAAI2H,GAAM/K,EAAOc,KAAKC,WAAWC,QAAQmC,iBAAiBC,EAC1DrE,MAAK4B,OAAOmE,IAAI,UAAWiG,OAK7BtK,GACPT,EAAOc,KAAKkK,iBAEfrM,GAAOD,QAAU+B","file":"postal.xwindow.min.js","sourcesContent":["/*!\n *  * postal.xwindow - postal.js/postal.federation plugin for federating instances of postal.js across unrelated window boundaries.\n *  * Author: Cornelius Wei√ü (http://www.metaways.de)\n *  * Version: v0.0.1\n *  * Url: http://github.com/tine20/postal.xwindow\n *  * License(s): (MIT OR GPL-2.0)\n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"), require(\"postal\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\", \"postal\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"postalXWindow\"] = factory(require(\"lodash\"), require(\"postal\"));\n\telse\n\t\troot[\"postalXWindow\"] = factory(root[\"_\"], root[\"postal\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// istanbul ignore next\n\t\n\tvar _interopRequire = function (obj) { return obj && obj.__esModule ? obj[\"default\"] : obj; };\n\t\n\tvar _ = _interopRequire(__webpack_require__(1));\n\t\n\tvar postal = _interopRequire(__webpack_require__(2));\n\t\n\tvar _utils = __webpack_require__(3);\n\t\n\tvar _memoRemoteByInstanceId = _utils._memoRemoteByInstanceId;\n\tvar _memoRemoteByTarget = _utils._memoRemoteByTarget;\n\tvar _disconnectClient = _utils._disconnectClient;\n\tvar safeSerialize = _utils.safeSerialize;\n\t\n\tvar _state = __webpack_require__(4);\n\t\n\tvar state = _state.state;\n\tvar env = _state.env;\n\t\n\tvar XWindowClient = _interopRequire(__webpack_require__(5));\n\t\n\tXWindowClient.getInstance = function (target, options, instanceId) {\n\t\treturn new XWindowClient(target, options, instanceId);\n\t};\n\t\n\tpostal.fedx.transports.xwindow = {\n\t\teagerSerialize: env.useEagerSerialize,\n\t\tremotes: [],\n\t\tXWindowClient: XWindowClient,\n\t\tconfigure: function configure(cfg) {\n\t\t\tif (cfg) {\n\t\t\t\tstate.config = _.defaults(_.extend(state.config, cfg), state.defaults);\n\t\t\t}\n\t\t\treturn state.config;\n\t\t},\n\t\tclearConfiguration: function clearConfiguration() {\n\t\t\tstate.config = _.extend({}, state.defaults);\n\t\t},\n\t\tdisconnect: function disconnect(options) {\n\t\t\toptions = options || {};\n\t\t\tvar clients = options.instanceId ?\n\t\t\t// an instanceId value or array was provided, let's get the client proxy instances for the id(s)\n\t\t\t_.reduce(_.isArray(options.instanceId) ? options.instanceId : [options.instanceId], _memoRemoteByInstanceId, [], this) :\n\t\t\t// Ok so we don't have instanceId(s), let's try target(s)\n\t\t\toptions.target ?\n\t\t\t// Ok, so we have a targets array, we need to iterate over it and get a list of the proxy/client instances\n\t\t\t_.reduce(_.isArray(options.target) ? options.target : [options.target], _memoRemoteByTarget, [], this) :\n\t\t\t// aww, heck - we don't have instanceId(s) or target(s), so it's ALL THE REMOTES\n\t\t\tthis.remotes;\n\t\t\tif (!options.doNotNotify) {\n\t\t\t\t_.each(clients, _disconnectClient, this);\n\t\t\t}\n\t\t\tthis.remotes = _.without.apply(null, [this.remotes].concat(clients));\n\t\t},\n\t\tgetTargets: function getTargets() {\n\t\t\tthis.tidyStorage();\n\t\t\treturn _.reduce(store.namespace(state.config.localStoragePrefix).getAll(), function (memo, targetData, id) {\n\t\t\t\tif (id.match(/\\.targetTimeout$/)) {\n\t\t\t\t\tvar targetId = id.split(\".\")[0];\n\t\t\t\t\tmemo.push({\n\t\t\t\t\t\ttargetId: targetId,\n\t\t\t\t\t\ttarget: store.namespace(state.config.localStoragePrefix + \".\" + targetId)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn memo;\n\t\t\t}, []);\n\t\t},\n\t\tsendMessage: function sendMessage(env) {\n\t\t\tvar envelope = env;\n\t\t\tif (state.config.safeSerialize) {\n\t\t\t\tenvelope = safeSerialize(_.cloneDeep(env));\n\t\t\t}\n\t\t\tvar instanceId = postal.instanceId();\n\t\n\t\t\t_.each(this.remotes, function (remote) {\n\t\t\t\tif (remote.instanceId != instanceId) {\n\t\t\t\t\tremote.sendMessage(envelope);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\twrapForTransport: env.useEagerSerialize ? function (packingSlip) {\n\t\t\treturn JSON.stringify({\n\t\t\t\tpostal: true,\n\t\t\t\tpackingSlip: packingSlip\n\t\t\t});\n\t\t} : function (packingSlip) {\n\t\t\treturn {\n\t\t\t\tpostal: true,\n\t\t\t\tpackingSlip: packingSlip\n\t\t\t};\n\t\t},\n\t\tunwrapFromTransport: function unwrapFromTransport(msgData) {\n\t\t\tif (typeof msgData === \"string\" && (env.useEagerSerialize || msgData.indexOf(\"\\\"postal\\\":true\") !== -1)) {\n\t\t\t\ttry {\n\t\t\t\t\treturn JSON.parse(msgData);\n\t\t\t\t} catch (ex) {\n\t\t\t\t\treturn {};\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn msgData;\n\t\t\t}\n\t\t},\n\t\trouteMessage: function routeMessage(event) {\n\t\t\tvar _this = this;\n\t\n\t\t\tvar parsed = this.unwrapFromTransport(event.newValue);\n\t\t\tif (parsed && parsed.postal) {\n\t\t\t\tvar remote;\n\t\n\t\t\t\t(function () {\n\t\t\t\t\tvar packingSlip = parsed.packingSlip;\n\t\t\t\t\tvar instanceId = packingSlip.instanceId;\n\t\t\t\t\tif (packingSlip && instanceId != postal.instanceId()) {\n\t\t\t\t\t\tremote = _.find(_this.remotes, function (x) {\n\t\t\t\t\t\t\treturn x.instanceId === instanceId;\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\tif (!remote) {\n\t\t\t\t\t\t\tremote = XWindowClient.getInstance(store.namespace(state.config.localStoragePrefix + \".\" + instanceId), {}, instanceId);\n\t\t\t\t\t\t\t_this.remotes.push(remote);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tremote.onMessage(packingSlip);\n\t\t\t\t\t}\n\t\t\t\t})();\n\t\t\t}\n\t\t},\n\t\tsignalReady: function signalReady(targets, callback) {\n\t\t\tvar instanceId = postal.instanceId();\n\t\t\tvar that = this;\n\t\n\t\t\tthis.target = store.namespace(state.config.localStoragePrefix + \".\" + instanceId);\n\t\t\tthis.target.on(\"message\", _.bind(this.routeMessage, this));\n\t\t\tthis.keepAlive();\n\t\n\t\t\ttargets = _.isArray(targets) ? targets : [targets];\n\t\t\ttargets = targets.length ? targets : this.getTargets();\n\t\t\tcallback = callback || function () {};\n\t\n\t\t\t_.each(targets, function (def) {\n\t\t\t\tif (def.targetId != instanceId) {\n\t\t\t\t\tvar remote = _.find(that.remotes, function (x) {\n\t\t\t\t\t\treturn x.instanceId === def.targetId;\n\t\t\t\t\t});\n\t\t\t\t\tif (!remote) {\n\t\t\t\t\t\tremote = XWindowClient.getInstance(def.target, {}, def.targetId);\n\t\t\t\t\t\tthat.remotes.push(remote);\n\t\t\t\t\t}\n\t\t\t\t\tremote.sendPing(callback);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t},\n\t\tkeepAlive: function keepAlive() {\n\t\t\tthis.target.set(\"targetTimeout\", new Date().getTime() + state.config.targetTimeout);\n\t\t\tthis.tidyStorage();\n\t\t\tthis.tidyRemotes();\n\t\n\t\t\t_.delay(_.bind(this.keepAlive, this), Math.round(state.config.targetTimeout / 2));\n\t\t},\n\t\ttidyStorage: function tidyStorage() {\n\t\t\tvar now = new Date().getTime();\n\t\t\t_.each(store.namespace(state.config.localStoragePrefix).getAll(), function (value, id) {\n\t\t\t\tif (id.match(/\\.targetTimeout$/) && value < now) {\n\t\t\t\t\tvar instanceId = id.split(\".\")[0];\n\t\t\t\t\tstore.namespace(state.config.localStoragePrefix + \".\" + instanceId).clear();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\ttidyRemotes: function tidyRemotes() {\n\t\t\tvar that = this;\n\t\t\t_.each(this.remotes, function (remote) {\n\t\t\t\tif (_.isEmpty(remote.target.getAll())) {\n\t\t\t\t\tthat.disconnect({ target: remote.target });\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// istanbul ignore next\n\t\n\tvar _interopRequire = function (obj) { return obj && obj.__esModule ? obj[\"default\"] : obj; };\n\t\n\t// istanbul ignore next\n\t\n\tvar _slicedToArray = function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { var _arr = []; for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done;) { _arr.push(_step.value); if (i && _arr.length === i) break; } return _arr; } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } };\n\t\n\texports._memoRemoteByInstanceId = _memoRemoteByInstanceId;\n\texports._memoRemoteByTarget = _memoRemoteByTarget;\n\texports._disconnectClient = _disconnectClient;\n\texports.safeSerialize = safeSerialize;\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _ = _interopRequire(__webpack_require__(1));\n\t\n\tfunction _memoRemoteByInstanceId(memo, instanceId) {\n\t\tvar proxy = _.find(this.remotes, function (x) {\n\t\t\treturn x.instanceId === instanceId;\n\t\t});\n\t\tif (proxy) {\n\t\t\tmemo.push(proxy);\n\t\t}\n\t\treturn memo;\n\t}\n\t\n\tfunction _memoRemoteByTarget(memo, tgt) {\n\t\tvar proxy = _.find(this.remotes, function (x) {\n\t\t\treturn x.target === tgt;\n\t\t});\n\t\tif (proxy) {\n\t\t\tmemo.push(proxy);\n\t\t}\n\t\treturn memo;\n\t}\n\t\n\tfunction _disconnectClient(client) {\n\t\tclient.disconnect();\n\t}\n\t\n\tfunction safeSerialize(envelope) {\n\t\tvar _iteratorNormalCompletion = true;\n\t\tvar _didIteratorError = false;\n\t\tvar _iteratorError = undefined;\n\t\n\t\ttry {\n\t\t\tfor (var _iterator = entries(envelope)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t\t\t\tvar _step$value = _slicedToArray(_step.value, 2);\n\t\n\t\t\t\tvar key = _step$value[0];\n\t\t\t\tvar val = _step$value[1];\n\t\n\t\t\t\tif (typeof val === \"function\") {\n\t\t\t\t\tdelete envelope[key];\n\t\t\t\t}\n\t\t\t\tif (_.isPlainObject(val)) {\n\t\t\t\t\tsafeSerialize(val);\n\t\t\t\t}\n\t\t\t\tif (_.isArray(val)) {\n\t\t\t\t\t_.each(val, safeSerialize);\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (err) {\n\t\t\t_didIteratorError = true;\n\t\t\t_iteratorError = err;\n\t\t} finally {\n\t\t\ttry {\n\t\t\t\tif (!_iteratorNormalCompletion && _iterator[\"return\"]) {\n\t\t\t\t\t_iterator[\"return\"]();\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tif (_didIteratorError) {\n\t\t\t\t\tthrow _iteratorError;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\treturn envelope;\n\t}\n\t\n\tvar entries = regeneratorRuntime.mark(function entries(obj) {\n\t\tvar _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, k;\n\t\n\t\treturn regeneratorRuntime.wrap(function entries$(context$1$0) {\n\t\t\twhile (1) switch (context$1$0.prev = context$1$0.next) {\n\t\t\t\tcase 0:\n\t\t\t\t\tif ([\"object\", \"function\"].indexOf(typeof obj) === -1) {\n\t\t\t\t\t\tobj = {};\n\t\t\t\t\t}\n\t\t\t\t\t_iteratorNormalCompletion = true;\n\t\t\t\t\t_didIteratorError = false;\n\t\t\t\t\t_iteratorError = undefined;\n\t\t\t\t\tcontext$1$0.prev = 4;\n\t\t\t\t\t_iterator = Object.keys(obj)[Symbol.iterator]();\n\t\n\t\t\t\tcase 6:\n\t\t\t\t\tif (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n\t\t\t\t\t\tcontext$1$0.next = 13;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tk = _step.value;\n\t\t\t\t\tcontext$1$0.next = 10;\n\t\t\t\t\treturn [k, obj[k]];\n\t\n\t\t\t\tcase 10:\n\t\t\t\t\t_iteratorNormalCompletion = true;\n\t\t\t\t\tcontext$1$0.next = 6;\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase 13:\n\t\t\t\t\tcontext$1$0.next = 19;\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase 15:\n\t\t\t\t\tcontext$1$0.prev = 15;\n\t\t\t\t\tcontext$1$0.t0 = context$1$0[\"catch\"](4);\n\t\t\t\t\t_didIteratorError = true;\n\t\t\t\t\t_iteratorError = context$1$0.t0;\n\t\n\t\t\t\tcase 19:\n\t\t\t\t\tcontext$1$0.prev = 19;\n\t\t\t\t\tcontext$1$0.prev = 20;\n\t\n\t\t\t\t\tif (!_iteratorNormalCompletion && _iterator[\"return\"]) {\n\t\t\t\t\t\t_iterator[\"return\"]();\n\t\t\t\t\t}\n\t\n\t\t\t\tcase 22:\n\t\t\t\t\tcontext$1$0.prev = 22;\n\t\n\t\t\t\t\tif (!_didIteratorError) {\n\t\t\t\t\t\tcontext$1$0.next = 25;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tthrow _iteratorError;\n\t\n\t\t\t\tcase 25:\n\t\t\t\t\treturn context$1$0.finish(22);\n\t\n\t\t\t\tcase 26:\n\t\t\t\t\treturn context$1$0.finish(19);\n\t\n\t\t\t\tcase 27:\n\t\t\t\tcase \"end\":\n\t\t\t\t\treturn context$1$0.stop();\n\t\t\t}\n\t\t}, entries, this, [[4, 15, 19, 27], [20,, 22, 26]]);\n\t});\n\texports.entries = entries;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// istanbul ignore next\n\t\n\tvar _interopRequire = function (obj) { return obj && obj.__esModule ? obj[\"default\"] : obj; };\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _ = _interopRequire(__webpack_require__(1));\n\t\n\tvar env = {\n\t\torigin: location.origin || location.protocol + \"//\" + location.host,\n\t\tisWorker: typeof window === \"undefined\" && postMessage && location,\n\t\t// I know, I KNOW. The alternative was very expensive perf & time-wise\n\t\t// so I saved you a perf hit by checking the stinking UA. Sigh.\n\t\t// I sought the opinion of several other devs. We all traveled\n\t\t// to the far east to consult with the wisdom of a monk - turns\n\t\t// out he didn\"t know JavaScript, and our passports were stolen on the\n\t\t// return trip. We stowed away aboard a freighter headed back to the\n\t\t// US and by the time we got back, no one had heard of IE 8 or 9. True story.\n\t\tuseEagerSerialize: /MSIE [8,9]/.test(navigator.userAgent)\n\t};\n\t\n\texports.env = env;\n\tvar defaults = {\n\t\tenabled: true,\n\t\tlocalStoragePrefix: \"postal.fedx.xwindow\",\n\t\ttargetTimeout: 60000, // 1 minute\n\t\tsafeSerialize: false\n\t};\n\t\n\tvar state = {\n\t\tworkers: [],\n\t\tconfig: _.extend({}, defaults),\n\t\tdefaults: defaults\n\t};\n\texports.state = state;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// istanbul ignore next\n\t\n\tvar _interopRequire = function (obj) { return obj && obj.__esModule ? obj[\"default\"] : obj; };\n\t\n\t// istanbul ignore next\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var key in props) { var prop = props[key]; prop.configurable = true; if (prop.value) prop.writable = true; } Object.defineProperties(target, props); } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\t// istanbul ignore next\n\t\n\tvar _get = function get(object, property, receiver) { var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc && desc.writable) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\t// istanbul ignore next\n\t\n\tvar _inherits = function (subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) subClass.__proto__ = superClass; };\n\t\n\t// istanbul ignore next\n\t\n\tvar _classCallCheck = function (instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } };\n\t\n\tvar postal = _interopRequire(__webpack_require__(2));\n\t\n\t//import _ from \"lodash\";\n\t\n\tvar XWindowClient = (function (_postal$fedx$FederationClient) {\n\t   function XWindowClient() {\n\t      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t         args[_key] = arguments[_key];\n\t      }\n\t\n\t      _classCallCheck(this, XWindowClient);\n\t\n\t      this.transportName = \"xwindow\";\n\t      _get(Object.getPrototypeOf(XWindowClient.prototype), \"constructor\", this).apply(this, args);\n\t   }\n\t\n\t   _inherits(XWindowClient, _postal$fedx$FederationClient);\n\t\n\t   _createClass(XWindowClient, {\n\t      send: {\n\t         value: function send(packingSlip) {\n\t            var msg = postal.fedx.transports.xwindow.wrapForTransport(packingSlip);\n\t            this.target.set(\"message\", msg);\n\t         }\n\t      }\n\t   });\n\t\n\t   return XWindowClient;\n\t})(postal.fedx.FederationClient);\n\t\n\tmodule.exports = XWindowClient;\n\n/***/ }\n/******/ ])\n});\n;"],"sourceRoot":"/source/"}